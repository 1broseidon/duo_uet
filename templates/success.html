<section class="section">
    <div class="container">
        <div class="success-container">
            <div class="has-text-centered mb-6">
                <div class="success-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"/>
                    </svg>
                </div>
                <h1 class="title is-2 mb-2">Authentication Successful</h1>
                <p class="subtitle is-5 has-text-grey mb-1">{{.AppName}}</p>
                <div class="mt-4">
                    {{if eq .AppType "dmp"}}
                        <span class="tag is-success is-light">Device Management Portal</span>
                    {{else if eq .AppType "v4"}}
                        <span class="tag is-success is-light">WebSDK v4</span>
                        <span class="tag is-light">Universal Prompt</span>
                    {{else if eq .AppType "oidc"}}
                        <span class="tag is-success is-light">OpenID Connect</span>
                        <span class="tag is-light">OAuth 2.0</span>
                    {{else if eq .AppType "saml"}}
                        <span class="tag is-success is-light">SAML 2.0</span>
                        <span class="tag is-light">Single Sign-On</span>
                    {{end}}
                </div>
            </div>

            <div class="success-info-grid">
                {{if eq .AppType "dmp"}}
                    <div class="success-info-item">
                        <div class="label">Status</div>
                        <div class="value">✓ Authenticated</div>
                    </div>
                    <div class="success-info-item">
                        <div class="label">Portal Access</div>
                        <div class="value">Device Management</div>
                    </div>
                    <div class="success-info-item">
                        <div class="label">Session</div>
                        <div class="value">Active</div>
                    </div>
                {{else if eq .AppType "v4"}}
                    <div class="success-info-item">
                        <div class="label">User</div>
                        <div class="value">{{if .UserEmail}}{{.UserEmail}}{{else}}Authenticated{{end}}</div>
                    </div>
                    <div class="success-info-item">
                        <div class="label">Auth Factor</div>
                        <div class="value">{{if .AuthFactor}}{{.AuthFactor}}{{else}}2FA{{end}}</div>
                    </div>
                    <div class="success-info-item">
                        <div class="label">Result</div>
                        <div class="value">{{if .AuthResult}}{{.AuthResult}}{{else}}success{{end}}</div>
                    </div>
                {{else if eq .AppType "oidc"}}
                    <div class="success-info-item">
                        <div class="label">User</div>
                        <div class="value">{{if .UserEmail}}{{.UserEmail}}{{else}}Authenticated{{end}}</div>
                    </div>
                    <div class="success-info-item">
                        <div class="label">Auth Method</div>
                        <div class="value">{{if .AuthFactor}}{{.AuthFactor}}{{else}}OpenID Connect{{end}}</div>
                    </div>
                    <div class="success-info-item">
                        <div class="label">Result</div>
                        <div class="value">{{if .AuthResult}}{{.AuthResult}}{{else}}success{{end}}</div>
                    </div>
                {{else if eq .AppType "saml"}}
                    <div class="success-info-item">
                        <div class="label">User</div>
                        <div class="value">{{if .UserEmail}}{{.UserEmail}}{{else}}Authenticated{{end}}</div>
                    </div>
                    <div class="success-info-item">
                        <div class="label">Auth Method</div>
                        <div class="value">{{if .AuthFactor}}{{.AuthFactor}}{{else}}SAML 2.0{{end}}</div>
                    </div>
                    <div class="success-info-item">
                        <div class="label">Result</div>
                        <div class="value">{{if .AuthResult}}{{.AuthResult}}{{else}}success{{end}}</div>
                    </div>
                {{end}}
            </div>

            <div class="response-card">
                <div class="response-header">
                    {{if eq .AppType "dmp"}}
                        <span class="response-label">Duo API Response</span>
                    {{else if eq .AppType "v4"}}
                        <span class="response-label">Duo API Response</span>
                    {{else if eq .AppType "oidc"}}
                        <span class="response-label">ID Token Claims</span>
                    {{else if eq .AppType "saml"}}
                        <span class="response-label">SAML Assertion Data</span>
                    {{end}}
                    <span class="response-tag">JSON</span>
                </div>
                <pre class="auth-token"><code>{{if .TokenData}}{{.TokenData}}{{else}}{
  "message": "No data available"
}{{end}}</code></pre>
            </div>

            <div class="buttons is-centered">
                <a href="/app/{{.AppID}}" class="button is-success is-medium">Test Again</a>
                <a href="/" class="button is-medium">← Back to Home</a>
            </div>
        </div>
    </div>
</section>





